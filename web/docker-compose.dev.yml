
# Frontend:  http://localhost:3000
# Backend:   http://localhost:3001
# Admin:     http://localhost:3002

services:
  backend:
    build:
      context: .
      dockerfile: backend/Dockerfile
    image: seanchangx/qbit-backend:dev
    container_name: qbit-backend-dev
    restart: unless-stopped
    ports:
      - "3001:3001"
      - "3002:3002"
    environment:
      - PORT=3001
      - ADMIN_PORT=3002
      - ADMIN_HOST=0.0.0.0
      - SESSION_SECRET=dev-secret-local-only
      - COOKIE_DOMAIN=localhost
      - FRONTEND_URL=http://localhost:3000
      - DEVICE_API_KEY=dev-test-key
      - MAX_DEVICE_CONNECTIONS=50
      # Google OAuth -- fill these in for login testing,
      # or leave empty to skip (poke will require login).
      - GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID:-}
      - GOOGLE_CLIENT_SECRET=${GOOGLE_CLIENT_SECRET:-}
      - GOOGLE_CALLBACK_URL=http://localhost:3000/auth/google/callback
    volumes:
      - qbit-data:/data

  frontend:
    build:
      context: .
      dockerfile: frontend/Dockerfile
    image: seanchangx/qbit-frontend:dev
    container_name: qbit-frontend-dev
    restart: unless-stopped
    ports:
      - "3000:80"
    volumes:
      - ./nginx.dev.conf:/etc/nginx/conf.d/default.conf

volumes:
  qbit-data:

